*.
CLEAN prompt: '<|im_start|>user\nIs there axolotl emoji? Only reply Yes or No.<|im_end|>\n<|im_start|>assistant\n'
CORRUPT prompt: '<|im_start|>user\nIs there otter emoji? Only reply Yes or No.<|im_end|>\n<|im_start|>assistant\n'

Loading checkpoint shards:  67%|██████▋   | 2/3 [00:07<00:03,  3.51s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:07<00:00,  2.39s/it]
====================================================================================================
ACTIVATION PATCHING RESULTS
====================================================================================================

BASELINE:
--------------------------------------------------------------------------------
                        Yes_logit     No_logit         Diff     Yes_prob      No_prob
--------------------------------------------------------------------------------
clean                     45.9002      49.7203      -3.8202       0.0215       0.9785
corrupt                   49.8625      46.1426       3.7199       0.9763       0.0237

Total effect (clean - corrupt logit_diff): -7.5401

====================================================================================================
COMPONENT PATCHING (corrupt -> patch in clean attn/mlp output at final token)
====================================================================================================

Component        Yes_logit   No_logit       Diff   Y_prob   N_prob   Recovery
-------------------------------------------------------------------------------------
L0_attn            49.8529    46.1424     3.7106   0.9761   0.0239       0.1%
L0_mlp             49.8610    46.1456     3.7154   0.9762   0.0238       0.1%
L1_attn            49.8612    46.1373     3.7238   0.9764   0.0236      -0.1%
L1_mlp             49.8659    46.1397     3.7262   0.9765   0.0235      -0.1%
L2_attn            49.8488    46.1418     3.7070   0.9760   0.0240       0.2%
L2_mlp             49.8583    46.1422     3.7161   0.9762   0.0238       0.1%
L3_attn            49.8701    46.1308     3.7393   0.9768   0.0232      -0.3%
L3_mlp             49.8708    46.1393     3.7314   0.9766   0.0234      -0.2%
L4_attn            49.8734    46.1286     3.7447   0.9769   0.0231      -0.3%
L4_mlp             49.8763    46.1174     3.7588   0.9772   0.0228      -0.5%
L5_attn            49.8628    46.1261     3.7367   0.9767   0.0233      -0.2%
L5_mlp             49.8591    46.1408     3.7183   0.9763   0.0237       0.0%
L6_attn            49.8676    46.1400     3.7276   0.9765   0.0235      -0.1%
L6_mlp             49.8752    46.1277     3.7475   0.9770   0.0230      -0.4%
L7_attn            49.8661    46.1356     3.7305   0.9766   0.0234      -0.1%
L7_mlp             49.8783    46.1666     3.7117   0.9761   0.0239       0.1%
L8_attn            49.8859    46.1463     3.7395   0.9768   0.0232      -0.3%
L8_mlp             49.8660    46.1689     3.6971   0.9758   0.0242       0.3%
L9_attn            49.8869    46.1285     3.7584   0.9772   0.0228      -0.5%
L9_mlp             49.9102    46.1009     3.8093   0.9783   0.0217      -1.2%
L10_attn           49.8146    46.1853     3.6293   0.9741   0.0259       1.2%
L10_mlp            49.8704    45.9923     3.8781   0.9797   0.0203      -2.1%
L11_attn           49.9335    46.1283     3.8052   0.9782   0.0218      -1.1%
L11_mlp            49.8593    46.1605     3.6988   0.9758   0.0242       0.3%
L12_attn           49.8402    46.0414     3.7989   0.9781   0.0219      -1.0%
L12_mlp            49.9353    46.0211     3.9142   0.9804   0.0196      -2.6%
L13_attn           49.9254    46.0088     3.9166   0.9805   0.0195      -2.6%
L13_mlp            49.9344    46.1977     3.7368   0.9767   0.0233      -0.2%
L14_attn           49.8588    46.1337     3.7251   0.9765   0.0235      -0.1%
L14_mlp            49.8875    46.0938     3.7937   0.9780   0.0220      -1.0%
L15_attn           49.7834    46.2298     3.5536   0.9722   0.0278       2.2%
L15_mlp            49.7435    46.1321     3.6114   0.9737   0.0263       1.4%
L16_attn           49.8638    46.1260     3.7378   0.9767   0.0233      -0.2%
L16_mlp            49.8301    46.1331     3.6970   0.9758   0.0242       0.3%
L17_attn           49.8597    45.8032     4.0565   0.9830   0.0170      -4.5%
L17_mlp            49.8428    45.9726     3.8702   0.9796   0.0204      -2.0%
L18_attn           49.7641    46.1130     3.6511   0.9747   0.0253       0.9%
L18_mlp            50.0732    45.6932     4.3800   0.9876   0.0124      -8.8%
L19_attn           49.4965    46.6957     2.8008   0.9427   0.0573      12.2%
L19_mlp            49.8920    46.0767     3.8152   0.9784   0.0216      -1.3%
L20_attn           50.3940    46.0449     4.3490   0.9872   0.0128      -8.3%
L20_mlp            50.3080    45.5691     4.7389   0.9913   0.0087     -13.5%
L21_attn           49.2850    46.7302     2.5548   0.9279   0.0721      15.5%
L21_mlp            50.4643    45.3213     5.1430   0.9942   0.0058     -18.9%
L22_attn           48.0911    47.5683     0.5228   0.6278   0.3722      42.4%
L22_mlp            48.7691    47.6468     1.1223   0.7544   0.2456      34.5%
L23_attn           50.2483    45.6201     4.6282   0.9903   0.0097     -12.0%
L23_mlp            48.6911    47.9912     0.6999   0.6682   0.3318      40.1%
L24_attn           49.6584    46.4877     3.1708   0.9597   0.0403       7.3%
L24_mlp            50.0330    46.3678     3.6651   0.9750   0.0250       0.7%
L25_attn           50.0436    45.8985     4.1450   0.9844   0.0156      -5.6%
L25_mlp            49.4543    46.2795     3.1748   0.9599   0.0401       7.2%
L26_attn           49.6335    46.2656     3.3679   0.9667   0.0333       4.7%
L26_mlp            48.4973    47.9257     0.5716   0.6391   0.3609      41.8%
L27_attn           49.8820    45.9230     3.9591   0.9813   0.0187      -3.2%
L27_mlp            49.2478    47.0875     2.1604   0.8966   0.1034      20.7%
L28_attn           49.9794    46.1519     3.8275   0.9787   0.0213      -1.4%
L28_mlp            49.6127    46.0496     3.5630   0.9724   0.0276       2.1%
L29_attn           49.3873    46.7342     2.6531   0.9342   0.0658      14.1%
L29_mlp            49.3387    45.7869     3.5518   0.9721   0.0279       2.2%
L30_attn           49.6132    46.3943     3.2189   0.9615   0.0385       6.6%
L30_mlp            49.5388    45.5201     4.0187   0.9823   0.0177      -4.0%
L31_attn           49.8894    45.9098     3.9795   0.9816   0.0184      -3.4%
L31_mlp            49.1679    46.2484     2.9195   0.9488   0.0512      10.6%
L32_attn           49.7666    46.2829     3.4837   0.9702   0.0298       3.1%
L32_mlp            50.3045    45.7764     4.5281   0.9893   0.0107     -10.7%
L33_attn           49.5770    46.1609     3.4161   0.9682   0.0318       4.0%
L33_mlp            49.7728    47.2963     2.4765   0.9225   0.0775      16.5%
L34_attn           49.8396    45.9624     3.8773   0.9797   0.0203      -2.1%
L34_mlp            51.4769    46.2898     5.1870   0.9944   0.0056     -19.5%
L35_attn           49.6266    46.7386     2.8880   0.9472   0.0528      11.0%
L35_mlp            49.5633    46.1634     3.3999   0.9677   0.0323       4.2%

====================================================================================================
LAYER PATCHING (corrupt -> patch in clean attn+mlp at final token)
====================================================================================================

Layer            Yes_logit   No_logit       Diff   Y_prob   N_prob   Recovery
-------------------------------------------------------------------------------------
L0                 49.8529    46.1424     3.7106   0.9761   0.0239       0.1%
L1                 49.8638    46.1350     3.7288   0.9765   0.0235      -0.1%
L2                 49.8476    46.1376     3.7101   0.9761   0.0239       0.1%
L3                 49.8658    46.1350     3.7308   0.9766   0.0234      -0.1%
L4                 49.8797    46.1171     3.7626   0.9773   0.0227      -0.6%
L5                 49.8554    46.1181     3.7373   0.9767   0.0233      -0.2%
L6                 49.8829    46.1118     3.7711   0.9775   0.0225      -0.7%
L7                 49.8885    46.1349     3.7536   0.9771   0.0229      -0.4%
L8                 49.8745    46.1660     3.7085   0.9761   0.0239       0.2%
L9                 49.9303    46.1075     3.8228   0.9786   0.0214      -1.4%
L10                49.8649    46.0835     3.7814   0.9777   0.0223      -0.8%
L11                49.9086    46.1026     3.8060   0.9782   0.0218      -1.1%
L12                49.9498    45.8922     4.0576   0.9830   0.0170      -4.5%
L13                49.9732    46.0998     3.8735   0.9796   0.0204      -2.0%
L14                49.9280    45.9622     3.9659   0.9814   0.0186      -3.3%
L15                49.7229    46.1510     3.5719   0.9727   0.0273       2.0%
L16                49.9304    46.1297     3.8008   0.9781   0.0219      -1.1%
L17                49.8500    45.8183     4.0318   0.9826   0.0174      -4.1%
L18                49.9212    45.7880     4.1331   0.9842   0.0158      -5.5%
L19                49.6011    46.4941     3.1070   0.9572   0.0428       8.1%
L20                50.3837    45.6250     4.7587   0.9915   0.0085     -13.8%
L21                49.8554    46.2181     3.6372   0.9743   0.0257       1.1%
L22                47.7860    47.9382    -0.1522   0.4620   0.5380      51.4%
L23                48.8503    47.8077     1.0426   0.7393   0.2607      35.5%
L24                49.7842    46.7024     3.0818   0.9561   0.0439       8.5%
L25                49.6167    46.1195     3.4972   0.9706   0.0294       3.0%
L26                48.3754    47.9681     0.4073   0.6004   0.3996      43.9%
L27                49.3611    47.0210     2.3401   0.9121   0.0879      18.3%
L28                49.7090    46.1856     3.5234   0.9713   0.0287       2.6%
L29                48.8873    46.4335     2.4538   0.9208   0.0792      16.8%
L30                49.3384    45.8596     3.4788   0.9701   0.0299       3.2%
L31                49.2064    46.0297     3.1767   0.9599   0.0401       7.2%
L32                50.2138    46.0802     4.1336   0.9842   0.0158      -5.5%
L33                49.4936    47.3357     2.1579   0.8964   0.1036      20.7%
L34                51.4418    46.1571     5.2847   0.9950   0.0050     -20.8%
L35                49.2201    47.0686     2.1515   0.8958   0.1042      20.8%

====================================================================================================
WINDOWED LAYER PATCHING (corrupt -> patch multiple consecutive layers)
====================================================================================================

--- Window size: 2 layers ---
Window           Yes_logit   No_logit       Diff   Y_prob   N_prob   Recovery
-------------------------------------------------------------------------------------
L0-L1              49.8514    46.1372     3.7142   0.9762   0.0238       0.1%
L1-L2              49.8453    46.1330     3.7123   0.9762   0.0238       0.1%
L2-L3              49.8549    46.1280     3.7268   0.9765   0.0235      -0.1%
L3-L4              49.8731    46.1124     3.7607   0.9773   0.0227      -0.5%
L4-L5              49.8651    46.0950     3.7701   0.9775   0.0225      -0.7%
L5-L6              49.8659    46.0907     3.7752   0.9776   0.0224      -0.7%
L6-L7              49.9107    46.1129     3.7978   0.9781   0.0219      -1.0%
L7-L8              49.8865    46.1638     3.7227   0.9764   0.0236      -0.0%
L8-L9              49.8704    46.1801     3.6903   0.9756   0.0244       0.4%
L9-L10             49.9195    46.1059     3.8136   0.9784   0.0216      -1.2%
L10-L11            49.9591    46.0358     3.9234   0.9806   0.0194      -2.7%
L11-L12            49.8647    46.0908     3.7738   0.9776   0.0224      -0.7%
L12-L13            49.9003    45.8184     4.0819   0.9834   0.0166      -4.8%
L13-L14            49.9967    45.9063     4.0904   0.9835   0.0165      -4.9%
L14-L15            49.8538    46.2273     3.6264   0.9741   0.0259       1.2%
L15-L16            49.8460    46.0972     3.7488   0.9770   0.0230      -0.4%
L16-L17            49.9478    45.6785     4.2693   0.9862   0.0138      -7.3%
L17-L18            50.0086    45.5223     4.4862   0.9889   0.0111     -10.2%
L18-L19            49.4073    46.5426     2.8647   0.9461   0.0539      11.3%
L19-L20            49.9405    46.3641     3.5764   0.9728   0.0272       1.9%
L20-L21            50.0508    46.1130     3.9379   0.9809   0.0191      -2.9%
L21-L22            47.8109    48.3779    -0.5670   0.3619   0.6381      56.9%
L22-L23            47.5460    48.4134    -0.8674   0.2958   0.7042      60.8%
L23-L24            48.4623    48.2470     0.2153   0.5536   0.4464      46.5%
L24-L25            49.5717    46.8708     2.7009   0.9371   0.0629      13.5%
L25-L26            48.1812    47.9102     0.2710   0.5673   0.4327      45.7%
L26-L27            47.9750    48.5035    -0.5286   0.3708   0.6292      56.3%
L27-L28            49.1211    46.9244     2.1968   0.9000   0.1000      20.2%
L28-L29            48.7418    46.5194     2.2224   0.9022   0.0978      19.9%
L29-L30            48.6703    46.5958     2.0745   0.8884   0.1116      21.8%
L30-L31            49.2334    46.0962     3.1371   0.9584   0.0416       7.7%
L31-L32            49.4402    46.2372     3.2029   0.9609   0.0391       6.9%
L32-L33            49.6102    47.4138     2.1964   0.8999   0.1001      20.2%
L33-L34            50.3537    47.2153     3.1383   0.9584   0.0416       7.7%
L34-L35            50.3282    46.7377     3.5905   0.9732   0.0268       1.7%

--- Window size: 3 layers ---
Window           Yes_logit   No_logit       Diff   Y_prob   N_prob   Recovery
-------------------------------------------------------------------------------------
L0-L2              49.8347    46.1357     3.6990   0.9758   0.0242       0.3%
L1-L3              49.8550    46.1231     3.7319   0.9766   0.0234      -0.2%
L2-L4              49.8652    46.1098     3.7554   0.9771   0.0229      -0.5%
L3-L5              49.8629    46.0873     3.7755   0.9776   0.0224      -0.7%
L4-L6              49.8811    46.0812     3.7999   0.9781   0.0219      -1.1%
L5-L7              49.8896    46.1054     3.7842   0.9778   0.0222      -0.9%
L6-L8              49.9003    46.1450     3.7553   0.9771   0.0229      -0.5%
L7-L9              49.8941    46.1913     3.7028   0.9759   0.0241       0.2%
L8-L10             49.8668    46.2137     3.6531   0.9747   0.0253       0.9%
L9-L11             50.0149    46.0988     3.9161   0.9805   0.0195      -2.6%
L10-L12            49.9417    46.0433     3.8984   0.9801   0.0199      -2.4%
L11-L13            49.8848    46.0228     3.8620   0.9794   0.0206      -1.9%
L12-L14            49.9644    45.8526     4.1117   0.9839   0.0161      -5.2%
L13-L15            49.9257    46.1048     3.8209   0.9786   0.0214      -1.3%
L14-L16            49.6947    46.2743     3.4204   0.9683   0.0317       4.0%
L15-L17            49.9295    45.8200     4.1095   0.9838   0.0162      -5.2%
L16-L18            49.9398    45.7184     4.2215   0.9855   0.0145      -6.7%
L17-L19            49.4768    46.5091     2.9677   0.9511   0.0489      10.0%
L18-L20            49.6690    46.8225     2.8466   0.9451   0.0549      11.6%
L19-L21            49.4275    47.1290     2.2985   0.9088   0.0912      18.9%
L20-L22            47.8288    48.4403    -0.6115   0.3517   0.6483      57.4%
L21-L23            47.3403    48.6922    -1.3519   0.2056   0.7944      67.3%
L22-L24            47.3140    48.7221    -1.4081   0.1965   0.8035      68.0%
L23-L25            48.2287    48.3022    -0.0735   0.4816   0.5184      50.3%
L24-L26            47.8346    48.4729    -0.6383   0.3456   0.6544      57.8%
L25-L27            47.8168    48.4597    -0.6429   0.3446   0.6554      57.9%
L26-L28            47.7293    48.4677    -0.7384   0.3233   0.6767      59.1%
L27-L29            48.5092    47.4370     1.0722   0.7450   0.2550      35.1%
L28-L30            48.5440    46.6690     1.8750   0.8670   0.1330      24.5%
L29-L31            48.0520    46.3824     1.6696   0.8415   0.1585      27.2%
L30-L32            49.6184    46.3875     3.2308   0.9620   0.0380       6.5%
L31-L33            48.8104    47.5659     1.2445   0.7763   0.2237      32.8%
L32-L34            50.7663    47.2674     3.4989   0.9707   0.0293       2.9%
L33-L35            49.3413    47.8118     1.5295   0.8219   0.1781      29.1%

--- Window size: 4 layers ---
Window           Yes_logit   No_logit       Diff   Y_prob   N_prob   Recovery
-------------------------------------------------------------------------------------
L0-L3              49.8459    46.1265     3.7194   0.9763   0.0237       0.0%
L1-L4              49.8626    46.1045     3.7581   0.9772   0.0228      -0.5%
L2-L5              49.8606    46.0836     3.7770   0.9776   0.0224      -0.8%
L3-L6              49.8696    46.0760     3.7936   0.9780   0.0220      -1.0%
L4-L7              49.8945    46.0837     3.8109   0.9784   0.0216      -1.2%
L5-L8              49.8894    46.1242     3.7652   0.9774   0.0226      -0.6%
L6-L9              49.9074    46.1602     3.7472   0.9770   0.0230      -0.4%
L7-L10             49.8827    46.2094     3.6733   0.9752   0.0248       0.6%
L8-L11             49.9572    46.1612     3.7960   0.9780   0.0220      -1.0%
L9-L12             49.9804    46.0734     3.9070   0.9803   0.0197      -2.5%
L10-L13            49.9964    45.9686     4.0278   0.9825   0.0175      -4.1%
L11-L14            49.9159    46.0073     3.9087   0.9803   0.0197      -2.5%
L12-L15            49.9179    45.9274     3.9906   0.9818   0.0182      -3.6%
L13-L16            49.9072    46.1563     3.7509   0.9770   0.0230      -0.4%
L14-L17            49.7314    46.0941     3.6374   0.9744   0.0256       1.1%
L15-L18            49.7747    45.9277     3.8470   0.9791   0.0209      -1.7%
L16-L19            49.5014    46.5163     2.9851   0.9519   0.0481       9.7%
L17-L20            49.8058    46.8023     3.0035   0.9527   0.0473       9.5%
L18-L21            49.0999    47.5472     1.5527   0.8253   0.1747      28.7%
L19-L22            47.0653    48.9389    -1.8736   0.1331   0.8669      74.2%
L20-L23            47.2695    48.7509    -1.4815   0.1852   0.8148      69.0%
L21-L24            47.0842    48.9449    -1.8607   0.1346   0.8654      74.0%
L22-L25            47.2302    48.7389    -1.5087   0.1811   0.8189      69.3%
L23-L26            47.2451    48.9912    -1.7461   0.1485   0.8515      72.5%
L24-L27            47.4494    48.9384    -1.4890   0.1841   0.8159      69.1%
L25-L28            47.7147    48.4090    -0.6943   0.3331   0.6669      58.5%
L26-L29            47.0749    48.8326    -1.7577   0.1471   0.8529      72.6%
L27-L30            48.2661    47.4720     0.7941   0.6887   0.3113      38.8%
L28-L31            48.0616    46.6080     1.4536   0.8106   0.1894      30.1%
L29-L32            48.3454    46.6244     1.7210   0.8483   0.1517      26.5%
L30-L33            49.2176    47.7777     1.4398   0.8084   0.1916      30.2%
L31-L34            49.7284    47.6236     2.1048   0.8914   0.1086      21.4%
L32-L35            49.6940    47.9873     1.7067   0.8464   0.1536      26.7%

====================================================================================================
RESIDUAL STREAM PATCHING (corrupt -> patch in clean resid at final token)
====================================================================================================

Location              Yes_logit   No_logit       Diff   Y_prob   N_prob   Recovery
------------------------------------------------------------------------------------------
resid_pre_L0            49.8625    46.1426     3.7199   0.9763   0.0237      -0.0%
resid_mid_L0            49.8610    46.1456     3.7154   0.9762   0.0238       0.1%
resid_pre_L1            49.8529    46.1424     3.7106   0.9761   0.0239       0.1%
resid_mid_L1            49.8659    46.1397     3.7262   0.9765   0.0235      -0.1%
resid_pre_L2            49.8514    46.1372     3.7142   0.9762   0.0238       0.1%
resid_mid_L2            49.8583    46.1422     3.7161   0.9762   0.0238       0.1%
resid_pre_L3            49.8347    46.1357     3.6990   0.9758   0.0242       0.3%
resid_mid_L3            49.8708    46.1393     3.7314   0.9766   0.0234      -0.2%
resid_pre_L4            49.8459    46.1265     3.7194   0.9763   0.0237       0.0%
resid_mid_L4            49.8763    46.1174     3.7588   0.9772   0.0228      -0.5%
resid_pre_L5            49.8554    46.1080     3.7474   0.9770   0.0230      -0.4%
resid_mid_L5            49.8591    46.1408     3.7183   0.9763   0.0237       0.0%
resid_pre_L6            49.8590    46.0860     3.7730   0.9775   0.0225      -0.7%
resid_mid_L6            49.8752    46.1277     3.7475   0.9770   0.0230      -0.4%
resid_pre_L7            49.8642    46.0770     3.7872   0.9778   0.0222      -0.9%
resid_mid_L7            49.8783    46.1666     3.7117   0.9761   0.0239       0.1%
resid_pre_L8            49.8708    46.0715     3.7993   0.9781   0.0219      -1.1%
resid_mid_L8            49.8660    46.1689     3.6971   0.9758   0.0242       0.3%
resid_pre_L9            49.8860    46.0908     3.7952   0.9780   0.0220      -1.0%
resid_mid_L9            49.9102    46.1009     3.8093   0.9783   0.0217      -1.2%
resid_pre_L10           49.8960    46.1055     3.7905   0.9779   0.0221      -0.9%
resid_mid_L10           49.8704    45.9923     3.8781   0.9797   0.0203      -2.1%
resid_pre_L11           49.8726    46.1265     3.7462   0.9769   0.0231      -0.3%
resid_mid_L11           49.8593    46.1605     3.6988   0.9758   0.0242       0.3%
resid_pre_L12           49.9400    46.1327     3.8073   0.9783   0.0217      -1.2%
resid_mid_L12           49.9353    46.0211     3.9142   0.9804   0.0196      -2.6%
resid_pre_L13           49.9256    46.0858     3.8398   0.9790   0.0210      -1.6%
resid_mid_L13           49.9344    46.1977     3.7368   0.9767   0.0233      -0.2%
resid_pre_L14           49.9846    45.9701     4.0145   0.9823   0.0177      -3.9%
resid_mid_L14           49.8875    46.0938     3.7937   0.9780   0.0220      -1.0%
resid_pre_L15           50.0192    45.9723     4.0469   0.9828   0.0172      -4.3%
resid_mid_L15           49.7435    46.1321     3.6114   0.9737   0.0263       1.4%
resid_pre_L16           49.9766    45.9892     3.9875   0.9818   0.0182      -3.5%
resid_mid_L16           49.8301    46.1331     3.6970   0.9758   0.0242       0.3%
resid_pre_L17           49.9748    45.9224     4.0524   0.9829   0.0171      -4.4%
resid_mid_L17           49.8428    45.9726     3.8702   0.9796   0.0204      -2.0%
resid_pre_L18           49.9518    45.6841     4.2677   0.9862   0.0138      -7.3%
resid_mid_L18           50.0732    45.6932     4.3800   0.9876   0.0124      -8.8%
resid_pre_L19           49.8982    45.6046     4.2936   0.9865   0.0135      -7.6%
resid_mid_L19           49.8920    46.0767     3.8152   0.9784   0.0216      -1.3%
resid_pre_L20           49.4202    46.3777     3.0424   0.9545   0.0455       9.0%
resid_mid_L20           50.3080    45.5691     4.7389   0.9913   0.0087     -13.5%
resid_pre_L21           49.7925    46.5691     3.2234   0.9617   0.0383       6.6%
resid_mid_L21           50.4643    45.3213     5.1430   0.9942   0.0058     -18.9%
resid_pre_L22           49.3024    47.1523     2.1502   0.8957   0.1043      20.8%
resid_mid_L22           48.7691    47.6468     1.1223   0.7544   0.2456      34.5%
resid_pre_L23           46.9140    49.0114    -2.0974   0.1094   0.8906      77.2%
resid_mid_L23           48.6911    47.9912     0.6999   0.6682   0.3318      40.1%
resid_pre_L24           46.5968    49.0846    -2.4879   0.0767   0.9233      82.3%
resid_mid_L24           50.0330    46.3678     3.6651   0.9750   0.0250       0.7%
resid_pre_L25           46.4770    49.1512    -2.6742   0.0645   0.9355      84.8%
resid_mid_L25           49.4543    46.2795     3.1748   0.9599   0.0401       7.2%
resid_pre_L26           46.4868    49.1475    -2.6607   0.0653   0.9347      84.6%
resid_mid_L26           48.4973    47.9257     0.5716   0.6391   0.3609      41.8%
resid_pre_L27           46.3286    49.3084    -2.9798   0.0483   0.9517      88.9%
resid_mid_L27           49.2478    47.0875     2.1604   0.8966   0.1034      20.7%
resid_pre_L28           46.2062    49.4255    -3.2193   0.0384   0.9616      92.0%
resid_mid_L28           49.6127    46.0496     3.5630   0.9724   0.0276       2.1%
resid_pre_L29           46.1922    49.4084    -3.2162   0.0386   0.9614      92.0%
resid_mid_L29           49.3387    45.7869     3.5518   0.9721   0.0279       2.2%
resid_pre_L30           46.1303    49.4495    -3.3192   0.0349   0.9651      93.4%
resid_mid_L30           49.5388    45.5201     4.0187   0.9823   0.0177      -4.0%
resid_pre_L31           46.0769    49.5249    -3.4480   0.0308   0.9692      95.1%
resid_mid_L31           49.1679    46.2484     2.9195   0.9488   0.0512      10.6%
resid_pre_L32           46.0343    49.5148    -3.4805   0.0299   0.9701      95.5%
resid_mid_L32           50.3045    45.7764     4.5281   0.9893   0.0107     -10.7%
resid_pre_L33           45.9827    49.5072    -3.5245   0.0286   0.9714      96.1%
resid_mid_L33           49.7728    47.2963     2.4765   0.9225   0.0775      16.5%
resid_pre_L34           46.0007    49.4659    -3.4652   0.0303   0.9697      95.3%
resid_mid_L34           51.4769    46.2898     5.1870   0.9944   0.0056     -19.5%
resid_pre_L35           45.9550    49.4832    -3.5282   0.0285   0.9715      96.1%
resid_mid_L35           49.5633    46.1634     3.3999   0.9677   0.0323       4.2%
resid_post_final        45.9002    49.7203    -3.8202   0.0215   0.9785     100.0%

====================================================================================================
TOP 30 MOST IMPACTFUL PATCHES (by absolute recovery %):
------------------------------------------------------------------------------------------
 1. resid_post_final     [resid    ] recovery=  100.0% | diff= -3.8202 | Y_prob=0.0215 N_prob=0.9785
 2. resid_pre_L35        [resid    ] recovery=   96.1% | diff= -3.5282 | Y_prob=0.0285 N_prob=0.9715
 3. resid_pre_L33        [resid    ] recovery=   96.1% | diff= -3.5245 | Y_prob=0.0286 N_prob=0.9714
 4. resid_pre_L32        [resid    ] recovery=   95.5% | diff= -3.4805 | Y_prob=0.0299 N_prob=0.9701
 5. resid_pre_L34        [resid    ] recovery=   95.3% | diff= -3.4652 | Y_prob=0.0303 N_prob=0.9697
 6. resid_pre_L31        [resid    ] recovery=   95.1% | diff= -3.4480 | Y_prob=0.0308 N_prob=0.9692
 7. resid_pre_L30        [resid    ] recovery=   93.4% | diff= -3.3192 | Y_prob=0.0349 N_prob=0.9651
 8. resid_pre_L28        [resid    ] recovery=   92.0% | diff= -3.2193 | Y_prob=0.0384 N_prob=0.9616
 9. resid_pre_L29        [resid    ] recovery=   92.0% | diff= -3.2162 | Y_prob=0.0386 N_prob=0.9614
10. resid_pre_L27        [resid    ] recovery=   88.9% | diff= -2.9798 | Y_prob=0.0483 N_prob=0.9517
11. resid_pre_L25        [resid    ] recovery=   84.8% | diff= -2.6742 | Y_prob=0.0645 N_prob=0.9355
12. resid_pre_L26        [resid    ] recovery=   84.6% | diff= -2.6607 | Y_prob=0.0653 N_prob=0.9347
13. resid_pre_L24        [resid    ] recovery=   82.3% | diff= -2.4879 | Y_prob=0.0767 N_prob=0.9233
14. resid_pre_L23        [resid    ] recovery=   77.2% | diff= -2.0974 | Y_prob=0.1094 N_prob=0.8906
15. L19-L22              [window   ] recovery=   74.2% | diff= -1.8736 | Y_prob=0.1331 N_prob=0.8669
16. L21-L24              [window   ] recovery=   74.0% | diff= -1.8607 | Y_prob=0.1346 N_prob=0.8654
17. L26-L29              [window   ] recovery=   72.6% | diff= -1.7577 | Y_prob=0.1471 N_prob=0.8529
18. L23-L26              [window   ] recovery=   72.5% | diff= -1.7461 | Y_prob=0.1485 N_prob=0.8515
19. L22-L25              [window   ] recovery=   69.3% | diff= -1.5087 | Y_prob=0.1811 N_prob=0.8189
20. L24-L27              [window   ] recovery=   69.1% | diff= -1.4890 | Y_prob=0.1841 N_prob=0.8159
21. L20-L23              [window   ] recovery=   69.0% | diff= -1.4815 | Y_prob=0.1852 N_prob=0.8148
22. L22-L24              [window   ] recovery=   68.0% | diff= -1.4081 | Y_prob=0.1965 N_prob=0.8035
23. L21-L23              [window   ] recovery=   67.3% | diff= -1.3519 | Y_prob=0.2056 N_prob=0.7944
24. L22-L23              [window   ] recovery=   60.8% | diff= -0.8674 | Y_prob=0.2958 N_prob=0.7042
25. L26-L28              [window   ] recovery=   59.1% | diff= -0.7384 | Y_prob=0.3233 N_prob=0.6767
26. L25-L28              [window   ] recovery=   58.5% | diff= -0.6943 | Y_prob=0.3331 N_prob=0.6669
27. L25-L27              [window   ] recovery=   57.9% | diff= -0.6429 | Y_prob=0.3446 N_prob=0.6554
28. L24-L26              [window   ] recovery=   57.8% | diff= -0.6383 | Y_prob=0.3456 N_prob=0.6544
29. L20-L22              [window   ] recovery=   57.4% | diff= -0.6115 | Y_prob=0.3517 N_prob=0.6483
30. L21-L22              [window   ] recovery=   56.9% | diff= -0.5670 | Y_prob=0.3619 N_prob=0.6381



====================================================================================================
HEAD-LEVEL PATCHING/ABLATION (ALL LAYERS)
Layers: 36, Heads per layer: 32, Head dim: 80
====================================================================================================

BASELINE:
--------------------------------------------------------------------------------
                 Yes_logit   No_logit       Diff     Y_prob     N_prob
--------------------------------------------------------------------------------
clean              45.9002    49.7203    -3.8202     0.0215     0.9785
corrupt            49.8625    46.1426     3.7199     0.9763     0.0237

Total effect (clean - corrupt logit_diff): -7.5401

====================================================================================================
TOP 30 HEADS BY ABLATION (sorted by closeness to clean_diff=-3.8202):
----------------------------------------------------------------------------------------------------
 1. L21H0    diff= +2.3539 | dist_to_clean=6.1741 | Y_prob=0.9132 N_prob=0.0868
 2. L19H0    diff= +2.3974 | dist_to_clean=6.2175 | Y_prob=0.9166 N_prob=0.0834
 3. L18H0    diff= +2.4265 | dist_to_clean=6.2467 | Y_prob=0.9188 N_prob=0.0812
 4. L18H28   diff= +2.8736 | dist_to_clean=6.6937 | Y_prob=0.9465 N_prob=0.0535
 5. L19H25   diff= +2.8875 | dist_to_clean=6.7077 | Y_prob=0.9472 N_prob=0.0528
 6. L23H0    diff= +2.9607 | dist_to_clean=6.7809 | Y_prob=0.9508 N_prob=0.0492
 7. L18H8    diff= +2.9868 | dist_to_clean=6.8069 | Y_prob=0.9520 N_prob=0.0480
 8. L20H0    diff= +3.0339 | dist_to_clean=6.8540 | Y_prob=0.9541 N_prob=0.0459
 9. L35H28   diff= +3.0867 | dist_to_clean=6.9069 | Y_prob=0.9563 N_prob=0.0437
10. L21H15   diff= +3.1344 | dist_to_clean=6.9546 | Y_prob=0.9583 N_prob=0.0417
11. L22H15   diff= +3.1717 | dist_to_clean=6.9918 | Y_prob=0.9598 N_prob=0.0402
12. L19H31   diff= +3.1986 | dist_to_clean=7.0188 | Y_prob=0.9608 N_prob=0.0392
13. L0H0     diff= +3.2331 | dist_to_clean=7.0532 | Y_prob=0.9621 N_prob=0.0379
14. L13H0    diff= +3.2339 | dist_to_clean=7.0541 | Y_prob=0.9621 N_prob=0.0379
15. L21H19   diff= +3.2425 | dist_to_clean=7.0626 | Y_prob=0.9624 N_prob=0.0376
16. L18H26   diff= +3.2477 | dist_to_clean=7.0678 | Y_prob=0.9626 N_prob=0.0374
17. L28H0    diff= +3.2489 | dist_to_clean=7.0690 | Y_prob=0.9626 N_prob=0.0374
18. L24H23   diff= +3.2575 | dist_to_clean=7.0776 | Y_prob=0.9629 N_prob=0.0371
19. L19H29   diff= +3.2579 | dist_to_clean=7.0781 | Y_prob=0.9630 N_prob=0.0370
20. L24H0    diff= +3.2595 | dist_to_clean=7.0797 | Y_prob=0.9630 N_prob=0.0370
21. L22H19   diff= +3.2644 | dist_to_clean=7.0846 | Y_prob=0.9632 N_prob=0.0368
22. L17H0    diff= +3.2691 | dist_to_clean=7.0892 | Y_prob=0.9634 N_prob=0.0366
23. L22H21   diff= +3.2882 | dist_to_clean=7.1084 | Y_prob=0.9640 N_prob=0.0360
24. L21H22   diff= +3.2919 | dist_to_clean=7.1120 | Y_prob=0.9641 N_prob=0.0359
25. L35H6    diff= +3.3133 | dist_to_clean=7.1334 | Y_prob=0.9649 N_prob=0.0351
26. L22H23   diff= +3.3238 | dist_to_clean=7.1439 | Y_prob=0.9652 N_prob=0.0348
27. L33H0    diff= +3.3367 | dist_to_clean=7.1569 | Y_prob=0.9657 N_prob=0.0343
28. L24H11   diff= +3.3437 | dist_to_clean=7.1639 | Y_prob=0.9659 N_prob=0.0341
29. L24H25   diff= +3.3453 | dist_to_clean=7.1655 | Y_prob=0.9660 N_prob=0.0340
30. L34H0    diff= +3.3462 | dist_to_clean=7.1664 | Y_prob=0.9660 N_prob=0.0340

====================================================================================================
TOP 30 HEADS BY PATCHING (sorted by closeness to clean_diff=-3.8202):
----------------------------------------------------------------------------------------------------
 1. L22H18   diff= +3.4531 | dist_to_clean=7.2733 | Y_prob=0.9693 N_prob=0.0307
 2. L22H28   diff= +3.4606 | dist_to_clean=7.2807 | Y_prob=0.9695 N_prob=0.0305
 3. L22H30   diff= +3.4716 | dist_to_clean=7.2918 | Y_prob=0.9699 N_prob=0.0301
 4. L22H16   diff= +3.4969 | dist_to_clean=7.3171 | Y_prob=0.9706 N_prob=0.0294
 5. L22H17   diff= +3.5035 | dist_to_clean=7.3237 | Y_prob=0.9708 N_prob=0.0292
 6. L19H23   diff= +3.5225 | dist_to_clean=7.3426 | Y_prob=0.9713 N_prob=0.0287
 7. L22H24   diff= +3.5240 | dist_to_clean=7.3442 | Y_prob=0.9714 N_prob=0.0286
 8. L22H23   diff= +3.5276 | dist_to_clean=7.3478 | Y_prob=0.9715 N_prob=0.0285
 9. L21H18   diff= +3.5413 | dist_to_clean=7.3615 | Y_prob=0.9718 N_prob=0.0282
10. L22H26   diff= +3.5435 | dist_to_clean=7.3636 | Y_prob=0.9719 N_prob=0.0281
11. L22H22   diff= +3.5495 | dist_to_clean=7.3697 | Y_prob=0.9721 N_prob=0.0279
12. L21H28   diff= +3.5546 | dist_to_clean=7.3748 | Y_prob=0.9722 N_prob=0.0278
13. L21H29   diff= +3.5553 | dist_to_clean=7.3755 | Y_prob=0.9722 N_prob=0.0278
14. L22H25   diff= +3.5559 | dist_to_clean=7.3760 | Y_prob=0.9722 N_prob=0.0278
15. L22H7    diff= +3.5582 | dist_to_clean=7.3783 | Y_prob=0.9723 N_prob=0.0277
16. L22H29   diff= +3.5657 | dist_to_clean=7.3858 | Y_prob=0.9725 N_prob=0.0275
17. L19H31   diff= +3.5743 | dist_to_clean=7.3945 | Y_prob=0.9727 N_prob=0.0273
18. L21H27   diff= +3.6001 | dist_to_clean=7.4203 | Y_prob=0.9734 N_prob=0.0266
19. L22H4    diff= +3.6006 | dist_to_clean=7.4208 | Y_prob=0.9734 N_prob=0.0266
20. L22H10   diff= +3.6041 | dist_to_clean=7.4242 | Y_prob=0.9735 N_prob=0.0265
21. L19H4    diff= +3.6063 | dist_to_clean=7.4265 | Y_prob=0.9736 N_prob=0.0264
22. L19H25   diff= +3.6064 | dist_to_clean=7.4265 | Y_prob=0.9736 N_prob=0.0264
23. L22H27   diff= +3.6109 | dist_to_clean=7.4311 | Y_prob=0.9737 N_prob=0.0263
24. L19H14   diff= +3.6123 | dist_to_clean=7.4325 | Y_prob=0.9737 N_prob=0.0263
25. L21H16   diff= +3.6159 | dist_to_clean=7.4361 | Y_prob=0.9738 N_prob=0.0262
26. L35H16   diff= +3.6166 | dist_to_clean=7.4367 | Y_prob=0.9738 N_prob=0.0262
27. L24H4    diff= +3.6180 | dist_to_clean=7.4382 | Y_prob=0.9739 N_prob=0.0261
28. L24H18   diff= +3.6182 | dist_to_clean=7.4384 | Y_prob=0.9739 N_prob=0.0261
29. L24H9    diff= +3.6194 | dist_to_clean=7.4396 | Y_prob=0.9739 N_prob=0.0261
30. L22H31   diff= +3.6223 | dist_to_clean=7.4425 | Y_prob=0.9740 N_prob=0.0260

